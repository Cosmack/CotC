namespace = maintenance

# Terran multiculturalism
province_event = {
	id = maintenance.1
	hide_window = yes
	
	trigger = { culture_group = terran_group }
	mean_time_to_happen = { months = 60 }
	immediate = {
		random_list = {
			30 = { culture = sino_terran }
			30 = { culture = indo_terran }
			20 = { culture = anglo_terran }
			20 = { culture = hispanic_terran }
			20 = { culture = arab_terran }
			10 = { culture = russo_terran }
			10 = { culture = iranian_terran }
			10 = { culture = mesoamerican_terran }
			10 = { culture = japanese_terran }
			10 = { culture = ethiopian_terran }
			10 = { culture = west_afro_terran }
			10 = { culture = east_afro_terran }
		}
	}
}

character_event = {
	id = maintenance.2
	hide_window = yes
	
	trigger = {
		dynasty = none
		NOT = { any_demesne_title = { always = yes } }
		NOT = { has_character_flag = flag_dynasty_changed }
	}
	
	immediate = {
		liege = {
			e_rebels = { holder_scope = { ROOT = { set_defacto_liege = PREV } } }
			ROOT = {
				dynasty = random
				set_defacto_liege = PREV
			}
		}
		set_character_flag = flag_dynasty_changed
	}
}

# Reset crown law timer
character_event = {
	id = maintenance.3
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			name = "Cabinet Meeting"
			dynasty = ROOT
			culture = ROOT
			religion = ROOT
			age = 20
		}
		new_character = {
			ROOT = { abdicate_to = PREV }
			abdicate_to = ROOT
			death = { death_reason = death_sacrifice }
		}
	}
}

# Family members
character_event = {
	id = maintenance.10
	hide_window = yes
	
	trigger = { father = { NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_parent } } } }
	
	immediate = { father = { reverse_opinion = { who = ROOT modifier = opinion_my_parent } } }
}
character_event = {
	id = maintenance.11
	hide_window = yes
	
	trigger = { mother = { NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_parent } } } }
	
	immediate = { mother = { reverse_opinion = { who = ROOT modifier = opinion_my_parent } } }
}
character_event = {
	id = maintenance.12
	hide_window = yes
	
	trigger = { any_child = { NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_child } } } }
	
	immediate = {
		any_child = {
			limit = { NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_child } } }
			reverse_opinion = { who = ROOT modifier = opinion_my_child }
		}
	}
}
character_event = {
	id = maintenance.13
	hide_window = yes
	
	trigger = {
		any_sibling = {
			is_older_than = ROOT
			NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_older_sibling } }
		}
	}
	
	immediate = {
		any_sibling = {
			limit = {
				is_older_than = ROOT
				NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_older_sibling } }
			}
			reverse_opinion = { who = ROOT modifier = opinion_my_older_sibling }
		}
	}
}
character_event = {
	id = maintenance.14
	hide_window = yes
	
	trigger = {
		any_sibling = {
			ROOT = { is_older_than = PREV }
			NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_younger_sibling } }
		}
	}
	
	immediate = {
		any_sibling = {
			limit = {
				ROOT = { is_older_than = PREV }
				NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_my_younger_sibling } }
			}
			reverse_opinion = { who = ROOT modifier = opinion_my_younger_sibling }
		}
	}
}

# Wrong holding type management for the AI
character_event = { # Theocracies - these are particularly troubling
	id = maintenance.20
	hide_window = yes
	
	only_rulers = yes
	
	trigger = {
		ai = yes
		is_theocracy = no
		any_demesne_title = {
			can_be_given_away = yes
			tier = count
			is_theocracy = yes
		}
	}
	
	immediate = {
		# If no courtiers are available, make one up
		if = {
			limit = {
				NOT = {
					any_courtier = {
						is_landed = no
						NOT = { dynasty = ROOT }
						age = 16
						prisoner = no
						NOT = { trait = incapable }
					}
				}
			}
			capital_scope = {
				ROOT = {
					random_list = {
						50 = {
							create_random_priest = {
								random_traits = yes
								age = 30
								culture = PREV
								religion = PREV
								dynasty = culture
								female = yes
							}
						}
						50 = {
							create_random_priest = {
								random_traits = yes
								age = 30
								culture = PREV
								religion = PREV
								dynasty = culture
								female = no
							}
						}
					}
				}
			}
		}
		random_courtier = {
			limit = {
				is_landed = no
				NOT = { dynasty = ROOT }
				age = 16
				prisoner = no
				NOT = { trait = incapable }
			}
			ROOT = {
				random_demesne_title = {
					limit = {
						can_be_given_away = yes
						tier = count
						is_theocracy = yes
					}
					grant_title = PREVPREV
					remove_claim = ROOT
				}
			}
		}
		character_event = { id = maintenance.20 } # Recursive
	}
}

# # Open elective titles with no successor
# character_event = {
	# id = maintenance.30
	# hide_window = yes
	
	# only_rulers = yes
	
	# trigger = {
		# any_demesne_title = {
			# has_law = succ_open_elective
			# NOT = { current_heir = { always = yes } }
		# }
	# }
	
	# immediate = {
		# capital_scope = {
			# ROOT = {
				# 50 = {
					# create_character = {
						# random_traits = yes
						# age = 25
						# culture = PREV
						# religion = PREV
						# dynasty = culture
						# is_female = yes
					# }
				# }
				# 50 = {
					# create_character = {
						# random_traits = yes
						# age = 25
						# culture = PREV
						# religion = PREV
						# dynasty = culture
						# is_female = no
					# }
				# }
			# }
		# }
	# }
# }